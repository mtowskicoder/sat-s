<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SMS Onay SatÄ±ÅŸ KataloÄŸu</title>
<style>
body { font-family: 'Poppins', sans-serif; background:#0f172a; color:white; padding:20px;}
h1{text-align:center;color:#38bdf8;}
.category{font-size:18px;color:#22d3ee;margin-top:15px;border-bottom:1px solid #334155;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px;}
.card{background:#1e293b;border-radius:12px;padding:15px;text-align:center;}
button{margin-top:10px;padding:8px;background:#38bdf8;border:none;color:white;border-radius:8px;cursor:pointer;}
</style>
</head>
<body>
  <h1>ðŸ“± SMS Onay Hizmetleri</h1>
  <div id="catalog"></div>

  <script>
  async function loadProducts(){
    const res=await fetch('/api/products');
    const products=await res.json();
    const grouped={};
    products.forEach(p=>{
      if(!grouped[p.category])grouped[p.category]=[];
      grouped[p.category].push(p);
    });
    const catalog=document.getElementById('catalog');
    catalog.innerHTML=Object.keys(grouped).map(cat=>`
      <div class="category">${cat}</div>
      <div class="grid">
        ${grouped[cat].map(p=>`
          <div class="card">
            <div class="name">${p.name}</div>
            <div>Stok: ${p.stock}</div>
            <div>Fiyat: ${p.price} â‚º</div>
            <button onclick="buy('${p.name}',${p.price})">SatÄ±n Al</button>
            <button onclick="info('${p.info}')">Bilgi</button>
          </div>`).join('')}
      </div>`).join('');
  }

  async function buy(name,price){
    const user=prompt("Telegram kullanÄ±cÄ± adÄ±nÄ± yaz (Ã¶rnek: mahmut123)");
    if(!user)return;
    await fetch('/api/purchase',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({name,price,user})
    });
    alert('SipariÅŸ talebin iletildi âœ…');
  }

  function info(i){alert(i);}
  loadProducts();
  </script>
</body>
</html>
