<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MTOW Market</title>

<style>
:root{
  --accent:#7c4dff;
  --text:#eaf0ff;
  --muted:#9aa4c7;
  --wa:#25D366;
  --tg:#229ED9;
}

/* KATEGORƒ∞ RENKLERƒ∞ */
body.pubg{--accent:#facc15;}
body.whatsapp{--accent:#22c55e;}
body.telegram{--accent:#38bdf8;}
body.default{--accent:#7c4dff;}

*{box-sizing:border-box}
html,body{
  margin:0;
  font-family:Inter,system-ui,Arial;
  color:var(--text);
}

/* üåå ARKA PLAN */
body{
  background:linear-gradient(-45deg,#050b18,#0b1224,#1a1440,#050b18);
  background-size:400% 400%;
  animation:bg 14s ease infinite;
}
@keyframes bg{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* HEADER */
header{
  position:fixed;
  top:0;left:0;right:0;
  height:60px;
  background:rgba(5,11,24,.9);
  backdrop-filter:blur(10px);
  display:flex;
  align-items:center;
  padding:0 14px;
  z-index:100;
}
.menuBtn{
  font-size:26px;
  cursor:pointer;
  margin-right:12px;
}
header h1{font-size:18px;color:var(--accent)}

/* SIDEBAR */
.sidebar{
  position:fixed;
  top:0;left:-260px;
  width:260px;
  height:100%;
  background:#0b1224;
  transition:.3s;
  z-index:200;
  padding:20px;
}
.sidebar.open{left:0}
.sidebar h2{color:var(--accent)}
.sidebar button{
  width:100%;
  background:none;
  border:0;
  color:var(--text);
  padding:12px 0;
  text-align:left;
  font-weight:800;
  cursor:pointer;
}
.subCats{
  padding-left:12px;
  display:none;
}
.subCats button{color:var(--muted)}
.subCats.show{display:block}

/* MAIN */
main{
  padding-top:70px;
  padding-bottom:20px;
  max-width:1100px;
  margin:auto;
}
.page{display:none;padding:16px}
.page.active{display:block}

/* ANNOUNCE */
.announce{
  background:rgba(15,24,51,.85);
  border-radius:18px;
  padding:16px;
  display:flex;
  gap:16px;
  align-items:center;
}
.announce img{
  width:120px;height:120px;
  border-radius:14px;
  object-fit:cover;
}
.announce p{color:var(--muted);font-weight:600}

/* PRODUCTS */
.prodGrid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:16px;
}
.card{
  background:rgba(15,24,51,.9);
  border-radius:18px;
  padding:14px;
}
.card img{
  width:100%;
  height:140px;
  object-fit:contain;
}
.price{color:#2dd4bf;font-weight:900}
.card button{
  width:100%;
  margin-top:12px;
  background:var(--accent);
  border:0;
  padding:12px;
  border-radius:12px;
  font-weight:900;
}

/* POPUP */
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.65);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:300;
}
.popupBox{
  background:#0b1224;
  border-radius:18px;
  padding:20px;
  width:90%;
  max-width:360px;
}
.popupBox button{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:0;
  margin-top:10px;
  font-weight:900;
}
.waBtn{background:var(--wa);color:#002b12}
.tgBtn{background:var(--tg);color:#00233a}
</style>
</head>

<body class="default">

<header>
  <div class="menuBtn" onclick="toggleMenu()">‚ò∞</div>
  <h1>MTOW Market</h1>
</header>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
  <h2>Men√º</h2>
  <button onclick="showHome()">üè† Ana Sayfa</button>
  <button onclick="toggleCats()">üõçÔ∏è Kategoriler</button>
  <div class="subCats" id="catList"></div>
</div>

<main>
  <!-- HOME -->
  <section id="home" class="page active">
    <div class="announce">
      <img id="annGif">
      <p id="annText">Y√ºkleniyor...</p>
    </div>
  </section>

  <!-- PRODUCTS -->
  <section id="products" class="page">
    <h2 id="prodTitle"></h2>
    <div class="prodGrid" id="prodGrid"></div>
  </section>
</main>

<!-- POPUP -->
<div class="popup" id="popup">
  <div class="popupBox">
    <h3 id="popName"></h3>
    <p id="popInfo"></p>
    <button class="waBtn" id="waBtn">WhatsApp</button>
    <button class="tgBtn" id="tgBtn">Telegram</button>
    <button onclick="closePopup()">Kapat</button>
  </div>
</div>

<script>
const ANN_JSON="data/announcements.json";
const PRODUCTS_JSON="data/products.json";

const WA_LINK="https://wa.me/6282261958495";
const TG_LINK="https://t.me/mtow_support"; // deƒüi≈ütir

let products={};

/* MENU */
function toggleMenu(){
  sidebar.classList.toggle("open");
}
function toggleCats(){
  catList.classList.toggle("show");
}

/* PAGE */
function showHome(){
  closeMenu();
  document.body.className="default";
  home.classList.add("active");
  productsPage(false);
}
function productsPage(show){
  home.classList.remove("active");
  products.classList.toggle("active",show);
}
function closeMenu(){
  sidebar.classList.remove("open");
}

/* ANNOUNCE */
fetch(ANN_JSON).then(r=>r.json()).then(a=>{
  annGif.src=a[0].gif;
  annText.innerText=a[0].content;
});

/* PRODUCTS */
fetch(PRODUCTS_JSON).then(r=>r.json()).then(p=>{
  products=p;
  renderCats();
});

function renderCats(){
  catList.innerHTML="";
  Object.keys(products).forEach(cat=>{
    const b=document.createElement("button");
    b.innerText=cat.toUpperCase();
    b.onclick=()=>openCategory(cat);
    catList.appendChild(b);
  });
}

function openCategory(cat){
  closeMenu();
  document.body.className=cat;
  productsPage(true);
  prodTitle.innerText=cat.toUpperCase();
  prodGrid.innerHTML="";
  products[cat].forEach(p=>{
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`
      <img src="${p.gif}">
      <h3>${p.name}</h3>
      <div class="price">${p.price}</div>
      <button>Satƒ±n Al</button>
    `;
    c.querySelector("button").onclick=()=>buyPopup(p,cat);
    prodGrid.appendChild(c);
  });
}

/* POPUP */
function buyPopup(p,cat){
  popName.innerText=p.name;
  popInfo.innerText=`Kategori: ${cat}\nFiyat: ${p.price}`;
  popup.style.display="flex";

  const msg=encodeURIComponent(
    `Merhaba, ${p.name} satƒ±n almak istiyorum (${p.price})`
  );
  waBtn.onclick=()=>window.open(WA_LINK+"?text="+msg);
  tgBtn.onclick=()=>window.open(TG_LINK+"?text="+msg);
}

function closePopup(){
  popup.style.display="none";
}
</script>

</body>
</html>
