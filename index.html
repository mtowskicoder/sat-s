<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ürün Kataloğu</title>
<style>
  body { margin:0; font-family: Arial, sans-serif; background:#0a0f30; color:#eee;}
  header { background:#120851; padding:12px; display:flex; justify-content:space-between; align-items:center; }
  h1 { margin:0; color:#bb88ff; }
  #categories { background:#1a0f50; padding:10px; border-radius:8px; display:flex; gap:8px; overflow-x:auto;}
  #categories button { background:#bb88ff; color:#0a0f30; border:none; border-radius:6px; padding:6px 12px; cursor:pointer; font-weight:bold;}
  #categories button:hover { background:#8b3aff; color:#fff; }
  #announcement { margin:20px; padding:15px; background:rgba(187,136,255,0.2); border-radius:12px; font-size:1.2rem;}
  #products { display:flex; flex-wrap:wrap; gap:12px; margin:20px;}
  .product { background:#1a0f50; padding:15px; border-radius:12px; width:220px; box-shadow:0 0 12px #bb88ff; }
  .product h2 { font-size:1.2rem; margin:0 0 8px 0; color:#bb88ff;}
  .product p { font-size:0.95rem; margin:0 0 10px 0;}
  .product button { background:#bb88ff; color:#0a0f30; border:none; border-radius:8px; padding:6px 10px; font-weight:bold; cursor:pointer; }
  .product button:hover { background:#8b3aff; color:#fff;}
</style>
</head>
<body>

<header>
  <h1>Ürün Kataloğu</h1>
  <div id="categoryMenu">
    <button onclick="loadCategory('all')">Tüm Ürünler</button>
  </div>
</header>

<div id="announcement">Yükleniyor...</div>

<div id="categories"></div>
<div id="products"></div>

<script>
const PRODUCTS_JSON = 'products.json'; // JSON dosyanın yolu
const ANNOUNCE_JSON = 'announcement.json'; // JSON dosyanın yolu

let productsData = [];

// JSON’dan duyuru çek
async function loadAnnouncement() {
  try {
    const res = await fetch(ANNOUNCE_JSON);
    const data = await res.json();
    document.getElementById('announcement').innerText = data.text || "Hoşgeldiniz!";
  } catch(e) { console.error(e); }
}

// JSON’dan ürünleri çek
async function loadProducts() {
  try {
    const res = await fetch(PRODUCTS_JSON);
    productsData = await res.json();
    buildCategories();
    displayProducts('all');
  } catch(e) { console.error(e); }
}

// Kategorileri oluştur
function buildCategories() {
  const cats = [...new Set(productsData.map(p => p.kategori))];
  const catDiv = document.getElementById('categories');
  catDiv.innerHTML = '';
  cats.forEach(cat => {
    const btn = document.createElement('button');
    btn.textContent = cat;
    btn.onclick = () => displayProducts(cat);
    catDiv.appendChild(btn);
  });
}

// Ürünleri göster
function displayProducts(category) {
  const container = document.getElementById('products');
  container.innerHTML = '';
  let filtered = productsData.filter(p => !p.sold);
  if(category !== 'all') filtered = filtered.filter(p => p.kategori === category);
  if(filtered.length===0){ container.innerHTML="<p>Bu kategoride ürün yok.</p>"; return;}
  filtered.forEach(p => {
    const div = document.createElement('div');
    div.className = 'product';
    div.innerHTML = `
      <h2>${p.ad} - $${p.fiyat}</h2>
      <p>${p.desc || ''}</p>
      <button onclick="window.open('https://t.me/mtowi','_blank')">Satın Al</button>
    `;
    container.appendChild(div);
  });
}

// Başlat
loadAnnouncement();
loadProducts();
</script>

</body>
</html>
