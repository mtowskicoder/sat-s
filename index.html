<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MTOW Market</title>

<link rel="manifest" href="manifest.json">

<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>

<style>
body{margin:0;font-family:Inter,Arial;background:#050b1e;color:#e8eeff}
header{height:64px;display:flex;align-items:center;justify-content:space-between;padding:0 16px;background:#060f2c}
.btn{padding:8px 14px;border-radius:10px;border:0;font-weight:800;background:#7c4dff;color:#021025}
main{max-width:1100px;margin:auto;padding:12px}
.card{background:rgba(255,255,255,.06);padding:14px;border-radius:12px;margin-bottom:14px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
.price{color:#2dd4bf;font-weight:900}
.buy{background:#7c4dff;color:#021025;border:0;padding:12px;border-radius:10px;font-weight:900;width:100%}
.popup{position:fixed;inset:0;background:#050b1e;display:none;align-items:center;justify-content:center}
.popup div{max-width:400px;width:100%;padding:20px}
</style>
</head>

<body>

<header>
<button class="btn" onclick="showHome()">üè† Ana Sayfa</button>
<div><b>MTOW</b></div>
</header>

<main>

<!-- HOME -->
<section id="home">
<h2>Duyurular</h2>
<div id="announcements"></div>
</section>

<!-- PRODUCTS -->
<section id="products" style="display:none">
<div class="grid" id="productGrid"></div>
</section>

</main>

<!-- BUY POPUP -->
<div class="popup" id="buyPop">
<div class="card">
<h3 id="bName"></h3>
<p id="bDesc"></p>
<p class="price" id="bPrice"></p>
<button class="buy" onclick="goWA()">WhatsApp</button><br><br>
<button class="buy" onclick="goTG()">Telegram</button><br><br>
<button class="btn" onclick="closeBuy()">Kapat</button>
</div>
</div>

<script>
let PRODUCTS={},current=null,cat="";

fetch("data/announcements.json")
.then(r=>r.json())
.then(d=>{
  const box=document.getElementById("announcements");
  d.forEach(a=>{
    box.innerHTML+=`<div class="card"><b>${a.title}</b><p>${a.content}</p></div>`;
  });
});

fetch("data/products.json").then(r=>r.json()).then(d=>PRODUCTS=d);

function showHome(){
document.getElementById("home").style.display="block";
document.getElementById("products").style.display="none";
}

function openCat(c){
cat=c;
home.style.display="none";
products.style.display="block";
productGrid.innerHTML="";
PRODUCTS[c].forEach(p=>{
productGrid.innerHTML+=`
<div class="card">
<b>${p.name}</b>
<p>${p.description}</p>
<div class="price">${p.price}</div>
<button class="buy" onclick='openBuy(${JSON.stringify(p)})'>Satƒ±n Al</button>
</div>`;
});
}

function openBuy(p){
current=p;
buyPop.style.display="flex";
bName.innerText=p.name;
bDesc.innerText=p.description;
bPrice.innerText=p.price;
}

function closeBuy(){buyPop.style.display="none"}
function goWA(){
window.open("https://wa.me/6282261958495?text="+encodeURIComponent(current.name),"blank");
}
function goTG(){
window.open("https://t.me/mtow1?text="+encodeURIComponent(current.name),"blank");
}
</script>

</body>
</html>
